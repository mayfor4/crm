<div class="header-events">
  <h3 class="header-title">Eventos</h3>
  <button class="btn btn-primary" (click)="goToInsertEvent()">
    <i class="fas fa-plus"></i> Nuevo Evento
  </button>
</div>

<div class="body-events">
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>

        <tr>
          <th>Nombre</th>
          <th>Estado</th>
          <th>Tipo</th>
          <th>Inicio</th>
          <th>Final</th>
          <th class="text-center">Acciones</th>
        </tr>
        <tr>
          <th>
            <input type="text" [(ngModel)]="filtros.nombre" placeholder="Buscar nombre" class="form-control form-control-sm">
          </th>
          <th>
            <select [(ngModel)]="filtros.estado" class="form-control form-control-sm">
              <option value="">Todos</option>
              <option *ngFor="let estado of estadosDisponibles" [value]="estado">{{ estado }}</option>
            </select>
          </th>
          <th>
            <select [(ngModel)]="filtros.tipo" class="form-control form-control-sm">
              <option value="">Todos</option>
              <option *ngFor="let tipo of tiposDisponibles" [value]="tipo">{{ tipo }}</option>
            </select>
          </th>
          <th>
            <select [(ngModel)]="filtros.ordenInicio" class="form-control form-control-sm">
              <option value="desc">Más reciente</option>
              <option value="asc">Más antiguo</option>
            </select>
          </th>
          <th>
            <select [(ngModel)]="filtros.ordenFinal" class="form-control form-control-sm">
              <option value="desc">Más reciente</option>
              <option value="asc">Más antiguo</option>
            </select>
          </th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let event of eventosFiltrados; trackBy: trackByEvent">
          <tr >
            <td data-label="Nombre">{{ event.nombre }}</td>
            <td data-label="Estado">
              <span class="badge" [ngClass]="{
                'badge-success': event.estado === 'Finalizado',
                'badge-warning': event.estado === 'En Proceso',
                'badge-danger': event.estado === 'Cancelado',
                'badge-purple': event.estado === 'Agendado'
              }">
                {{ event.estado }}
              </span>
            </td>
            <td data-label="Tipo">{{ event.tipo }}</td>
            <td data-label="Inicio">{{ event.inicio | date: 'dd-MM-yyyy' }}</td>
            <td data-label="Final">{{ event.final | date: 'dd-MM-yyyy' }}</td>
            <td data-label="Acciones">
              <!-- Botón para ver detalles -->
              <button 
                (click)="toggleDetalles(event.id)" 
                class="btn btn-primary btn-sm">
                <i class="fas" [class.fa-chevron-down]="!mostrarDetalles[event.id]" [class.fa-chevron-up]="mostrarDetalles[event.id]"></i>
                {{ mostrarDetalles[event.id] ? 'Ocultar' : 'Detalles' }}
              </button>
            
              <!-- Botón para editar -->
              <button
                (click)="goToUpdateEvent(event.id)"  
                class="btn btn-warning btn-sm" 
                style="margin-left: 3%; margin-right: 3%;">
                <i class="fas fa-edit"></i> Editar
              </button>
            
              <!-- Botón para eliminar -->
              <button 
                (click)="eliminarEvento(event.id)" 
                class="btn btn-danger btn-sm">
                <i class="fas fa-trash-alt"></i> Eliminar
              </button>
            </td>
          </tr>
          <tr *ngIf="mostrarDetalles[event.id]">
            <td colspan="6">
              <div class="detalles-container">
                <p><strong>Participantes:</strong> {{ event.participantes }}</p>
                <p><strong>Confirmados:</strong> {{ event.confirmados }}</p>
                <p><strong>Participaciones:</strong> {{ event.participaciones }}</p>
                <p><strong>No Participaciones:</strong> {{ event.noParticipaciones }}</p>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>